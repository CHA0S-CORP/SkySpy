import{r as e,j as a}from"./index-B4LxErAX.js";function n({data:e,dataKey:n,color:t,label:l,unit:r,formatFn:s,positionPercent:i=null,graphZoom:o=1,graphScrollOffset:h=0,onWheel:c,onDragStart:u,onDragMove:g,onDragEnd:m,onResetZoom:d,width:p=200,height:x=40}){if(!e||e.length<2)return null;const f=[...e].reverse().map(e=>e[n]).filter(e=>null!=e);if(f.length<2)return null;const M=Math.min(...f),v=Math.max(...f),j=v-M||1;let k,D,b,y,N,X;if(o>1){X=100/o,y=h,N=y+X,k=f.map((e,a)=>{const n=a/(f.length-1)*100;if(n<y||n>N)return null;return{x:2+(n-y)/X*(p-4),y:x-2-(e-M)/j*(x-4),value:e,dataPercent:n}}).filter(Boolean);const e=k.map(e=>e.value);D=e.length>0?Math.min(...e):M,b=e.length>0?Math.max(...e):v}else y=0,N=100,X=100,k=f.map((e,a)=>({x:2+a/(f.length-1)*(p-4),y:x-2-(e-M)/j*(x-4),value:e,dataPercent:a/(f.length-1)*100})),D=M,b=v;const C=k.map(e=>`${e.x},${e.y}`).join(" "),W=s||(e=>null==e?void 0:e.toLocaleString());let $=null,G=null,S=null;if(null!==i)if(i>=y&&i<=N){$=2+(i-y)/X*(p-4);const e=Math.floor(i/100*(f.length-1));S=f[Math.max(0,Math.min(e,f.length-1))],G=x-2-(S-M)/j*(x-4)}else{const e=Math.floor(i/100*(f.length-1));S=f[Math.max(0,Math.min(e,f.length-1))]}return a.jsxs("div",{className:"mini-graph "+(o>1?"zoomable":""),onWheel:c,onMouseDown:u,onMouseMove:g,onMouseUp:m,onMouseLeave:m,onTouchStart:u,onTouchMove:g,onTouchEnd:m,role:"img","aria-label":`${l} graph showing values from ${W(D)} to ${W(b)} ${r}`,children:[a.jsxs("div",{className:"mini-graph-header",children:[a.jsx("span",{className:"mini-graph-label",children:l}),o>1&&a.jsxs("button",{className:"mini-graph-zoom",onClick:d,title:"Reset zoom","aria-label":"Reset graph zoom",children:[o.toFixed(1),"x"]}),null!==S&&a.jsxs("span",{className:"mini-graph-current",style:{color:t},"aria-live":"polite",children:[W(S)," ",r]})]}),a.jsxs("svg",{width:p,height:x,className:"mini-graph-svg","aria-hidden":"true",children:[k.length>1&&a.jsx("polyline",{points:C,fill:"none",stroke:t,strokeWidth:"1.5",opacity:"0.6"}),null!==$&&null!==G&&a.jsxs(a.Fragment,{children:[a.jsx("line",{x1:$,y1:0,x2:$,y2:x,stroke:t,strokeWidth:"2",opacity:"0.9"}),a.jsx("circle",{cx:$,cy:G,r:"4",fill:t,stroke:"#000",strokeWidth:"1"})]})]}),a.jsxs("div",{className:"mini-graph-range","aria-hidden":"true",children:[a.jsxs("span",{children:[W(D)," ",r]}),a.jsxs("span",{children:[W(b)," ",r]})]})]})}function t(a,n,t,l){const r=e.useRef({isDragging:!1,startX:0,startOffset:0});return{handleGraphWheel:e.useCallback(e=>{e.preventDefault();const a=e.deltaY>0?-.25:.25;n(e=>{const n=Math.max(1,Math.min(8,e+a));if(n<e){const e=Math.max(0,100-100/n);l(a=>Math.min(a,e))}return n})},[n,l]),handleGraphDragStart:e.useCallback(e=>{var n,l;a<=1||(r.current={isDragging:!0,startX:e.clientX||(null==(l=null==(n=e.touches)?void 0:n[0])?void 0:l.clientX)||0,startOffset:t})},[a,t]),handleGraphDragMove:e.useCallback(e=>{var n,t;if(!r.current.isDragging)return;const s=e.clientX||(null==(t=null==(n=e.touches)?void 0:n[0])?void 0:t.clientX)||0,i=r.current.startX-s,o=100/a,h=100-o,c=i/200*o,u=Math.max(0,Math.min(h,r.current.startOffset+c));l(u)},[a,l]),handleGraphDragEnd:e.useCallback(()=>{r.current.isDragging=!1},[]),resetGraphZoom:e.useCallback(()=>{n(1),l(0)},[n,l])}}export{n as M,t as u};
